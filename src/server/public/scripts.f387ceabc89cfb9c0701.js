var Guacamole;(Guacamole=Guacamole||{}).ArrayBufferReader=function(e){var t=this;e.onblob=function(e){for(var n=window.atob(e),a=new ArrayBuffer(n.length),o=new Uint8Array(a),r=0;r<n.length;r++)o[r]=n.charCodeAt(r);t.ondata&&t.ondata(a)},e.onend=function(){t.onend&&t.onend()},this.ondata=null,this.onend=null},(Guacamole=Guacamole||{}).ArrayBufferWriter=function(e){var t=this;function n(t){for(var n="",a=0;a<t.byteLength;a++)n+=String.fromCharCode(t[a]);e.sendBlob(window.btoa(n))}e.onack=function(e){t.onack&&t.onack(e)},this.blobLength=Guacamole.ArrayBufferWriter.DEFAULT_BLOB_LENGTH,this.sendData=function(e){var a=new Uint8Array(e);if(a.length<=t.blobLength)n(a);else for(var o=0;o<a.length;o+=t.blobLength)n(a.subarray(o,o+t.blobLength))},this.sendEnd=function(){e.sendEnd()},this.onack=null},Guacamole.ArrayBufferWriter.DEFAULT_BLOB_LENGTH=6048,(Guacamole=Guacamole||{}).AudioContextFactory={singleton:null,getAudioContext:function(){var e=window.AudioContext||window.webkitAudioContext;if(e)try{return Guacamole.AudioContextFactory.singleton||(Guacamole.AudioContextFactory.singleton=new e),Guacamole.AudioContextFactory.singleton}catch(e){}return null}},(Guacamole=Guacamole||{}).AudioPlayer=function(){this.sync=function(){}},Guacamole.AudioPlayer.isSupportedType=function(e){return Guacamole.RawAudioPlayer.isSupportedType(e)},Guacamole.AudioPlayer.getSupportedTypes=function(){return Guacamole.RawAudioPlayer.getSupportedTypes()},Guacamole.AudioPlayer.getInstance=function(e,t){return Guacamole.RawAudioPlayer.isSupportedType(t)?new Guacamole.RawAudioPlayer(e,t):null},Guacamole.RawAudioPlayer=function(e,t){var n=Guacamole.RawAudioFormat.parse(t),a=Guacamole.AudioContextFactory.getAudioContext(),o=a.currentTime,r=new Guacamole.ArrayBufferReader(e),i=1===n.bytesPerSample?window.Int8Array:window.Int16Array,s=1===n.bytesPerSample?128:32768,u=[];r.ondata=function(e){!function(e){u.push(new i(e))}(new i(e));var t=function(){var e=function(e){if(e.length<=1)return e[0];var t=0;e.forEach(function(e){t+=e.length});var n=0,a=new i(t);return e.forEach(function(e){a.set(e,n),n+=e.length}),a}(u);return e?e=(u=function(e){for(var t=Number.MAX_VALUE,a=e.length,o=Math.floor(e.length/n.channels),r=Math.floor(.02*n.rate),s=Math.max(n.channels*r,n.channels*(o-r));s<e.length;s+=n.channels){for(var u=0,c=0;c<n.channels;c++)u+=Math.abs(e[s+c]);u<=t&&(a=s+n.channels,t=u)}return a===e.length?[e]:[new i(e.buffer.slice(0,a*n.bytesPerSample)),new i(e.buffer.slice(a*n.bytesPerSample))]}(e)).shift():null}();if(t){var r=a.currentTime;o<r&&(o=r);var c=a.createBufferSource();c.connect(a.destination),c.start||(c.start=c.noteOn),c.buffer=function(e){var t=e.length/n.channels,r=a.currentTime;o<r&&(o=r);for(var i=a.createBuffer(n.channels,t,n.rate),u=0;u<n.channels;u++)for(var c=i.getChannelData(u),l=u,d=0;d<t;d++)c[d]=e[l]/s,l+=n.channels;return i}(t),c.start(o),o+=t.length/n.channels/n.rate}},this.sync=function(){o=Math.min(o,a.currentTime+.3)}},Guacamole.RawAudioPlayer.prototype=new Guacamole.AudioPlayer,Guacamole.RawAudioPlayer.isSupportedType=function(e){return!!Guacamole.AudioContextFactory.getAudioContext()&&null!==Guacamole.RawAudioFormat.parse(e)},Guacamole.RawAudioPlayer.getSupportedTypes=function(){return Guacamole.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]},(Guacamole=Guacamole||{}).AudioRecorder=function(){this.onclose=null,this.onerror=null},Guacamole.AudioRecorder.isSupportedType=function(e){return Guacamole.RawAudioRecorder.isSupportedType(e)},Guacamole.AudioRecorder.getSupportedTypes=function(){return Guacamole.RawAudioRecorder.getSupportedTypes()},Guacamole.AudioRecorder.getInstance=function(e,t){return Guacamole.RawAudioRecorder.isSupportedType(t)?new Guacamole.RawAudioRecorder(e,t):null},Guacamole.RawAudioRecorder=function(e,t){var n=this,a=Guacamole.RawAudioFormat.parse(t),o=Guacamole.AudioContextFactory.getAudioContext(),r=(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator),i=new Guacamole.ArrayBufferWriter(e),s=1===a.bytesPerSample?window.Int8Array:window.Int16Array,u=1===a.bytesPerSample?128:32768,c=0,l=0,d=null,h=null,f=null,m=function(e){if(0===e)return 1;var t=Math.PI*e;return Math.sin(t)/t},p=function(e,t){return-t<e&&e<t?m(e)*m(e/t):0},g=function(e,t){for(var n=(e.length-1)*t,a=Math.floor(n)-3+1,o=Math.floor(n)+3,r=0,i=a;i<=o;i++)r+=(e[i]||0)*p(n-i,3);return r};i.onack=function(e){e.code!==Guacamole.Status.Code.SUCCESS||d?(function(){if(h&&h.disconnect(),f&&f.disconnect(),d)for(var e=d.getTracks(),t=0;t<e.length;t++)e[t].stop();f=null,h=null,d=null,i.sendEnd()}(),i.onack=null,e.code===Guacamole.Status.Code.RESOURCE_CLOSED?n.onclose&&n.onclose():n.onerror&&n.onerror()):r({audio:!0},function(e){(f=o.createScriptProcessor(2048,a.channels,a.channels)).connect(o.destination),f.onaudioprocess=function(e){i.sendData(function(e){var t=Math.round((c+=e.length)*a.rate/e.sampleRate)-l;l+=t;for(var n=new s(t*a.channels),o=0;o<a.channels;o++)for(var r=e.getChannelData(o),i=o,d=0;d<t;d++)n[i]=g(r,d/(t-1))*u,i+=a.channels;return n}(e.inputBuffer).buffer)},(h=o.createMediaStreamSource(e)).connect(f),d=e},function(){i.sendEnd(),n.onerror&&n.onerror()})}},Guacamole.RawAudioRecorder.prototype=new Guacamole.AudioRecorder,Guacamole.RawAudioRecorder.isSupportedType=function(e){return!!Guacamole.AudioContextFactory.getAudioContext()&&null!==Guacamole.RawAudioFormat.parse(e)},Guacamole.RawAudioRecorder.getSupportedTypes=function(){return Guacamole.AudioContextFactory.getAudioContext()?["audio/L8","audio/L16"]:[]},(Guacamole=Guacamole||{}).BlobReader=function(e,t){var n,a=this,o=0;n=window.BlobBuilder?new BlobBuilder:window.WebKitBlobBuilder?new WebKitBlobBuilder:window.MozBlobBuilder?new MozBlobBuilder:new function(){var e=[];this.append=function(n){e.push(new Blob([n],{type:t}))},this.getBlob=function(){return new Blob(e,{type:t})}},e.onblob=function(t){for(var r=window.atob(t),i=new ArrayBuffer(r.length),s=new Uint8Array(i),u=0;u<r.length;u++)s[u]=r.charCodeAt(u);n.append(i),o+=i.byteLength,a.onprogress&&a.onprogress(i.byteLength),e.sendAck("OK",0)},e.onend=function(){a.onend&&a.onend()},this.getLength=function(){return o},this.getBlob=function(){return n.getBlob()},this.onprogress=null,this.onend=null},(Guacamole=Guacamole||{}).BlobWriter=function(e){var t=this,n=new Guacamole.ArrayBufferWriter(e);n.onack=function(e){t.onack&&t.onack(e)},this.sendBlob=function(e){var a=0,o=new FileReader,r=function(){if(a>=e.size)t.oncomplete&&t.oncomplete(e);else{var r=function(e,t,n){var a=(e.slice||e.webkitSlice||e.mozSlice).bind(e),o=n-t;if(o!==n){var r=a(t,o);if(r.size===o)return r}return a(t,n)}(e,a,a+n.blobLength);a+=n.blobLength,o.readAsArrayBuffer(r)}};o.onload=function(){n.sendData(o.result),n.onack=function(o){t.onack&&t.onack(o),o.isError()||(t.onprogress&&t.onprogress(e,a-n.blobLength),r())}},o.onerror=function(){t.onerror&&t.onerror(e,a,o.error)},r()},this.sendEnd=function(){n.sendEnd()},this.onack=null,this.onerror=null,this.onprogress=null,this.oncomplete=null},(Guacamole=Guacamole||{}).Client=function(e){var t=this,n=2,a=3,o=0,r=0,i=null,s={0:"butt",1:"round",2:"square"},u={0:"bevel",1:"miter",2:"round"},c=new Guacamole.Display,l={},d={},h={},f=[],m=[],p=[],g=new Guacamole.IntegerPool,v=[];function y(e){e!=o&&(o=e,t.onstatechange&&t.onstatechange(o))}function w(){return o==a||o==n}this.exportState=function(e){var t={currentState:o,currentTimestamp:r,layers:{}},n={};for(var a in l)n[a]=l[a];c.flush(function(){for(var a in n){var o=parseInt(a),r=n[a],i=r.toCanvas(),s={width:r.width,height:r.height};r.width&&r.height&&(s.url=i.toDataURL("image/png")),o>0&&(s.x=r.x,s.y=r.y,s.z=r.z,s.alpha=r.alpha,s.matrix=r.matrix,s.parent=b(r.parent)),t.layers[a]=s}e(t)})},this.importState=function(e,t){var n,a;for(n in o=e.currentState,r=e.currentTimestamp,l)(a=parseInt(n))>0&&c.dispose(l[n]);for(n in l={},e.layers){a=parseInt(n);var i=e.layers[n],s=S(a);if(c.resize(s,i.width,i.height),i.url&&(c.setChannelMask(s,Guacamole.Layer.SRC),c.draw(s,0,0,i.url)),a>0&&i.parent>=0){var u=S(i.parent);c.move(s,u,i.x,i.y,i.z),c.shade(s,i.alpha);var d=i.matrix;c.distort(s,d[0],d[1],d[2],d[3],d[4],d[5])}}c.flush(t)},this.getDisplay=function(){return c},this.sendSize=function(t,n){w()&&e.sendMessage("size",t,n)},this.sendKeyEvent=function(t,n){w()&&e.sendMessage("key",n,t)},this.sendMouseState=function(t){if(w()){c.moveCursor(Math.floor(t.x),Math.floor(t.y));var n=0;t.left&&(n|=1),t.middle&&(n|=2),t.right&&(n|=4),t.up&&(n|=8),t.down&&(n|=16),e.sendMessage("mouse",Math.floor(t.x),Math.floor(t.y),n)}},this.setClipboard=function(e){if(w()){for(var n=t.createClipboardStream("text/plain"),a=new Guacamole.StringWriter(n),o=0;o<e.length;o+=4096)a.sendText(e.substring(o,o+4096));a.sendEnd()}},this.createOutputStream=function(){var e=g.next();return v[e]=new Guacamole.OutputStream(t,e)},this.createAudioStream=function(n){var a=t.createOutputStream();return e.sendMessage("audio",a.index,n),a},this.createFileStream=function(n,a){var o=t.createOutputStream();return e.sendMessage("file",o.index,n,a),o},this.createPipeStream=function(n,a){var o=t.createOutputStream();return e.sendMessage("pipe",o.index,n,a),o},this.createClipboardStream=function(n){var a=t.createOutputStream();return e.sendMessage("clipboard",a.index,n),a},this.createObjectOutputStream=function(n,a,o){var r=t.createOutputStream();return e.sendMessage("put",n,r.index,a,o),r},this.requestObjectInputStream=function(t,n){w()&&e.sendMessage("get",t,n)},this.sendAck=function(t,n,a){w()&&e.sendMessage("ack",t,n,a)},this.sendBlob=function(t,n){w()&&e.sendMessage("blob",t,n)},this.endStream=function(t){w()&&(e.sendMessage("end",t),v[t]&&(g.free(t),delete v[t]))},this.onstatechange=null,this.onname=null,this.onerror=null,this.onaudio=null,this.onvideo=null,this.onclipboard=null,this.onfile=null,this.onfilesystem=null,this.onpipe=null,this.onsync=null;var S=function(e){var t=l[e];return t||(t=0===e?c.getDefaultLayer():e>0?c.createLayer():c.createBuffer(),l[e]=t),t},b=function(e){if(!e)return null;for(var t in l)if(e===l[t])return parseInt(t);return null},G={"miter-limit":function(e,t){c.setMiterLimit(e,parseFloat(t))}},T={ack:function(e){var t=parseInt(e[0]),n=e[1],a=parseInt(e[2]),o=v[t];o&&(o.onack&&o.onack(new Guacamole.Status(a,n)),a>=256&&v[t]===o&&(g.free(t),delete v[t]))},arc:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),o=parseInt(e[3]),r=parseFloat(e[4]),i=parseFloat(e[5]),s=parseInt(e[6]);c.arc(t,n,a,o,r,i,0!=s)},audio:function(e){var n=parseInt(e[0]),a=e[1],o=m[n]=new Guacamole.InputStream(t,n),r=null;t.onaudio&&(r=t.onaudio(o,a)),r||(r=Guacamole.AudioPlayer.getInstance(o,a)),r?(d[n]=r,t.sendAck(n,"OK",0)):t.sendAck(n,"BAD TYPE",783)},blob:function(e){var t=parseInt(e[0]),n=m[t];n&&n.onblob&&n.onblob(e[1])},body:function(e){var n=parseInt(e[0]),a=p[n],o=parseInt(e[1]),r=e[2],i=e[3];if(a&&a.onbody){var s=m[o]=new Guacamole.InputStream(t,o);a.onbody(s,r,i)}else t.sendAck(o,"Receipt of body unsupported",256)},cfill:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),a=parseInt(e[2]),o=parseInt(e[3]),r=parseInt(e[4]),i=parseInt(e[5]);c.setChannelMask(n,t),c.fillColor(n,a,o,r,i)},clip:function(e){var t=S(parseInt(e[0]));c.clip(t)},clipboard:function(e){var n=parseInt(e[0]),a=e[1];if(t.onclipboard){var o=m[n]=new Guacamole.InputStream(t,n);t.onclipboard(o,a)}else t.sendAck(n,"Clipboard unsupported",256)},close:function(e){var t=S(parseInt(e[0]));c.close(t)},copy:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),o=parseInt(e[3]),r=parseInt(e[4]),i=parseInt(e[5]),s=S(parseInt(e[6])),u=parseInt(e[7]),l=parseInt(e[8]);c.setChannelMask(s,i),c.copy(t,n,a,o,r,s,u,l)},cstroke:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),a=s[parseInt(e[2])],o=u[parseInt(e[3])],r=parseInt(e[4]),i=parseInt(e[5]),l=parseInt(e[6]),d=parseInt(e[7]),h=parseInt(e[8]);c.setChannelMask(n,t),c.strokeColor(n,a,o,r,i,l,d,h)},cursor:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),a=S(parseInt(e[2])),o=parseInt(e[3]),r=parseInt(e[4]),i=parseInt(e[5]),s=parseInt(e[6]);c.setCursor(t,n,a,o,r,i,s)},curve:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),o=parseInt(e[3]),r=parseInt(e[4]),i=parseInt(e[5]),s=parseInt(e[6]);c.curveTo(t,n,a,o,r,i,s)},disconnect:function(e){t.disconnect()},dispose:function(e){var t=parseInt(e[0]);if(t>0){var n=S(t);c.dispose(n),delete l[t]}else t<0&&delete l[t]},distort:function(e){var t=parseInt(e[0]),n=parseFloat(e[1]),a=parseFloat(e[2]),o=parseFloat(e[3]),r=parseFloat(e[4]),i=parseFloat(e[5]),s=parseFloat(e[6]);if(t>=0){var u=S(t);c.distort(u,n,a,o,r,i,s)}},error:function(e){var n=e[0],a=parseInt(e[1]);t.onerror&&t.onerror(new Guacamole.Status(a,n)),t.disconnect()},end:function(e){var t=parseInt(e[0]),n=m[t];n&&(n.onend&&n.onend(),delete m[t])},file:function(e){var n=parseInt(e[0]),a=e[1],o=e[2];if(t.onfile){var r=m[n]=new Guacamole.InputStream(t,n);t.onfile(r,a,o)}else t.sendAck(n,"File transfer unsupported",256)},filesystem:function(e){var n=parseInt(e[0]),a=e[1];if(t.onfilesystem){var o=p[n]=new Guacamole.Object(t,n);t.onfilesystem(o,a)}},identity:function(e){var t=S(parseInt(e[0]));c.setTransform(t,1,0,0,1,0,0)},img:function(e){var n=parseInt(e[0]),a=parseInt(e[1]),o=S(parseInt(e[2])),r=e[3],i=parseInt(e[4]),s=parseInt(e[5]),u=m[n]=new Guacamole.InputStream(t,n),l=new Guacamole.DataURIReader(u,r);l.onend=function(){c.setChannelMask(o,a),c.draw(o,i,s,l.getURI())}},jpeg:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),a=parseInt(e[2]),o=parseInt(e[3]),r=e[4];c.setChannelMask(n,t),c.draw(n,a,o,"data:image/jpeg;base64,"+r)},lfill:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),a=S(parseInt(e[2]));c.setChannelMask(n,t),c.fillLayer(n,a)},line:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]);c.lineTo(t,n,a)},lstroke:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),a=S(parseInt(e[2]));c.setChannelMask(n,t),c.strokeLayer(n,a)},mouse:function(e){var t=parseInt(e[0]),n=parseInt(e[1]);c.showCursor(!0),c.moveCursor(t,n)},move:function(e){var t=parseInt(e[0]),n=parseInt(e[1]),a=parseInt(e[2]),o=parseInt(e[3]),r=parseInt(e[4]);if(t>0&&n>=0){var i=S(t),s=S(n);c.move(i,s,a,o,r)}},name:function(e){t.onname&&t.onname(e[0])},nest:function(t){(function(t){var n=f[t];return null==n&&((n=f[t]=new Guacamole.Parser).oninstruction=e.oninstruction),n})(parseInt(t[0])).receive(t[1])},pipe:function(e){var n=parseInt(e[0]),a=e[1],o=e[2];if(t.onpipe){var r=m[n]=new Guacamole.InputStream(t,n);t.onpipe(r,a,o)}else t.sendAck(n,"Named pipes unsupported",256)},png:function(e){var t=parseInt(e[0]),n=S(parseInt(e[1])),a=parseInt(e[2]),o=parseInt(e[3]),r=e[4];c.setChannelMask(n,t),c.draw(n,a,o,"data:image/png;base64,"+r)},pop:function(e){var t=S(parseInt(e[0]));c.pop(t)},push:function(e){var t=S(parseInt(e[0]));c.push(t)},rect:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),o=parseInt(e[3]),r=parseInt(e[4]);c.rect(t,n,a,o,r)},reset:function(e){var t=S(parseInt(e[0]));c.reset(t)},set:function(e){var t=S(parseInt(e[0])),n=G[e[1]];n&&n(t,e[2])},shade:function(e){var t=parseInt(e[0]),n=parseInt(e[1]);if(t>=0){var a=S(t);c.shade(a,n)}},size:function(e){var t=parseInt(e[0]),n=S(t),a=parseInt(e[1]),o=parseInt(e[2]);c.resize(n,a,o)},start:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]);c.moveTo(t,n,a)},sync:function(i){var s=parseInt(i[0]);c.flush(function(){for(var t in d){var n=d[t];n&&n.sync()}s!==r&&(e.sendMessage("sync",s),r=s)}),o===n&&y(a),t.onsync&&t.onsync(s)},transfer:function(e){var t=S(parseInt(e[0])),n=parseInt(e[1]),a=parseInt(e[2]),o=parseInt(e[3]),r=parseInt(e[4]),i=parseInt(e[5]),s=S(parseInt(e[6])),u=parseInt(e[7]),l=parseInt(e[8]);3===i?c.put(t,n,a,o,r,s,u,l):5!==i&&c.transfer(t,n,a,o,r,s,u,l,Guacamole.Client.DefaultTransferFunction[i])},transform:function(e){var t=S(parseInt(e[0])),n=parseFloat(e[1]),a=parseFloat(e[2]),o=parseFloat(e[3]),r=parseFloat(e[4]),i=parseFloat(e[5]),s=parseFloat(e[6]);c.transform(t,n,a,o,r,i,s)},undefine:function(e){var t=parseInt(e[0]),n=p[t];n&&n.onundefine&&n.onundefine()},video:function(e){var n=parseInt(e[0]),a=S(parseInt(e[1])),o=e[2],r=m[n]=new Guacamole.InputStream(t,n),i=null;t.onvideo&&(i=t.onvideo(r,a,o)),i||(i=Guacamole.VideoPlayer.getInstance(r,a,o)),i?(h[n]=i,t.sendAck(n,"OK",0)):t.sendAck(n,"BAD TYPE",783)}};e.oninstruction=function(e,t){var n=T[e];n&&n(t)},this.disconnect=function(){5!=o&&4!=o&&(y(4),i&&window.clearInterval(i),e.sendMessage("disconnect"),e.disconnect(),y(5))},this.connect=function(t){y(1);try{e.connect(t)}catch(e){throw y(0),e}i=window.setInterval(function(){e.sendMessage("nop")},5e3),y(n)}},Guacamole.Client.DefaultTransferFunction={0:function(e,t){t.red=t.green=t.blue=0},15:function(e,t){t.red=t.green=t.blue=255},3:function(e,t){t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha},5:function(e,t){},12:function(e,t){t.red=255&~e.red,t.green=255&~e.green,t.blue=255&~e.blue,t.alpha=e.alpha},10:function(e,t){t.red=255&~t.red,t.green=255&~t.green,t.blue=255&~t.blue},1:function(e,t){t.red=e.red&t.red,t.green=e.green&t.green,t.blue=e.blue&t.blue},14:function(e,t){t.red=255&~(e.red&t.red),t.green=255&~(e.green&t.green),t.blue=255&~(e.blue&t.blue)},7:function(e,t){t.red=e.red|t.red,t.green=e.green|t.green,t.blue=e.blue|t.blue},8:function(e,t){t.red=255&~(e.red|t.red),t.green=255&~(e.green|t.green),t.blue=255&~(e.blue|t.blue)},6:function(e,t){t.red=e.red^t.red,t.green=e.green^t.green,t.blue=e.blue^t.blue},9:function(e,t){t.red=255&~(e.red^t.red),t.green=255&~(e.green^t.green),t.blue=255&~(e.blue^t.blue)},4:function(e,t){t.red=~e.red&t.red&255,t.green=~e.green&t.green&255,t.blue=~e.blue&t.blue&255},13:function(e,t){t.red=255&(~e.red|t.red),t.green=255&(~e.green|t.green),t.blue=255&(~e.blue|t.blue)},2:function(e,t){t.red=e.red&~t.red&255,t.green=e.green&~t.green&255,t.blue=e.blue&~t.blue&255},11:function(e,t){t.red=255&(e.red|~t.red),t.green=255&(e.green|~t.green),t.blue=255&(e.blue|~t.blue)}},(Guacamole=Guacamole||{}).DataURIReader=function(e,t){var n=this,a="data:"+t+";base64,";e.onblob=function(e){a+=e},e.onend=function(){n.onend&&n.onend()},this.getURI=function(){return a},this.onend=null},(Guacamole=Guacamole||{}).Display=function(){var e=this,t=0,n=0,a=1,o=document.createElement("div");o.style.position="relative",o.style.width=t+"px",o.style.height=n+"px",o.style.transformOrigin=o.style.webkitTransformOrigin=o.style.MozTransformOrigin=o.style.OTransformOrigin=o.style.msTransformOrigin="0 0";var r=new Guacamole.Display.VisibleLayer(t,n),i=new Guacamole.Display.VisibleLayer(0,0);i.setChannelMask(Guacamole.Layer.SRC),o.appendChild(r.getElement()),o.appendChild(i.getElement());var s=document.createElement("div");s.style.position="relative",s.style.width=t*a+"px",s.style.height=n*a+"px",s.appendChild(o),this.cursorHotspotX=0,this.cursorHotspotY=0,this.cursorX=0,this.cursorY=0,this.onresize=null,this.oncursor=null;var u=[],c=[];function l(){for(var e=0;e<c.length;){var t=c[e];if(!t.isReady())break;t.flush(),e++}c.splice(0,e)}function d(e,t){var n=new function(e,t){var n=this;this.blocked=t,this.unblock=function(){n.blocked&&(n.blocked=!1,l())},this.execute=function(){e&&e()}}(e,t);return u.push(n),n}this.getElement=function(){return s},this.getWidth=function(){return t},this.getHeight=function(){return n},this.getDefaultLayer=function(){return r},this.getCursorLayer=function(){return i},this.createLayer=function(){var e=new Guacamole.Display.VisibleLayer(t,n);return e.move(r,0,0,0),e},this.createBuffer=function(){var e=new Guacamole.Layer(0,0);return e.autosize=1,e},this.flush=function(e){c.push(new function(e,t){this.isReady=function(){for(var e=0;e<t.length;e++)if(t[e].blocked)return!1;return!0},this.flush=function(){for(var n=0;n<t.length;n++)t[n].execute();e&&e()}}(e,u)),u=[],l()},this.setCursor=function(t,n,a,o,r,s,u){d(function(){e.cursorHotspotX=t,e.cursorHotspotY=n,i.resize(s,u),i.copy(a,o,r,s,u,0,0),e.moveCursor(e.cursorX,e.cursorY),e.oncursor&&e.oncursor(i.toCanvas(),t,n)})},this.showCursor=function(e){var t=i.getElement(),n=t.parentNode;!1===e?n&&n.removeChild(t):n!==o&&o.appendChild(t)},this.moveCursor=function(t,n){i.translate(t-e.cursorHotspotX,n-e.cursorHotspotY),e.cursorX=t,e.cursorY=n},this.resize=function(i,u,c){d(function(){i.resize(u,c),i===r&&(n=c,o.style.width=(t=u)+"px",o.style.height=n+"px",s.style.width=t*a+"px",s.style.height=n*a+"px",e.onresize&&e.onresize(u,c))})},this.drawImage=function(e,t,n,a){d(function(){e.drawImage(t,n,a)})},this.drawBlob=function(e,t,n,a){var o=URL.createObjectURL(a),r=d(function(){i.width&&i.height&&e.drawImage(t,n,i),URL.revokeObjectURL(o)},!0),i=new Image;i.onload=r.unblock,i.onerror=r.unblock,i.src=o},this.draw=function(e,t,n,a){var o=d(function(){r.width&&r.height&&e.drawImage(t,n,r)},!0),r=new Image;r.onload=o.unblock,r.onerror=o.unblock,r.src=a},this.play=function(e,t,n,a){var o=document.createElement("video");o.type=t,o.src=a,o.addEventListener("play",function(){!function t(){e.drawImage(0,0,o),o.ended||window.setTimeout(t,20)}()},!1),d(o.play)},this.transfer=function(e,t,n,a,o,r,i,s,u){d(function(){r.transfer(e,t,n,a,o,i,s,u)})},this.put=function(e,t,n,a,o,r,i,s){d(function(){r.put(e,t,n,a,o,i,s)})},this.copy=function(e,t,n,a,o,r,i,s){d(function(){r.copy(e,t,n,a,o,i,s)})},this.moveTo=function(e,t,n){d(function(){e.moveTo(t,n)})},this.lineTo=function(e,t,n){d(function(){e.lineTo(t,n)})},this.arc=function(e,t,n,a,o,r,i){d(function(){e.arc(t,n,a,o,r,i)})},this.curveTo=function(e,t,n,a,o,r,i){d(function(){e.curveTo(t,n,a,o,r,i)})},this.close=function(e){d(function(){e.close()})},this.rect=function(e,t,n,a,o){d(function(){e.rect(t,n,a,o)})},this.clip=function(e){d(function(){e.clip()})},this.strokeColor=function(e,t,n,a,o,r,i,s){d(function(){e.strokeColor(t,n,a,o,r,i,s)})},this.fillColor=function(e,t,n,a,o){d(function(){e.fillColor(t,n,a,o)})},this.strokeLayer=function(e,t,n,a,o){d(function(){e.strokeLayer(t,n,a,o)})},this.fillLayer=function(e,t){d(function(){e.fillLayer(t)})},this.push=function(e){d(function(){e.push()})},this.pop=function(e){d(function(){e.pop()})},this.reset=function(e){d(function(){e.reset()})},this.setTransform=function(e,t,n,a,o,r,i){d(function(){e.setTransform(t,n,a,o,r,i)})},this.transform=function(e,t,n,a,o,r,i){d(function(){e.transform(t,n,a,o,r,i)})},this.setChannelMask=function(e,t){d(function(){e.setChannelMask(t)})},this.setMiterLimit=function(e,t){d(function(){e.setMiterLimit(t)})},this.dispose=function(e){d(function(){e.dispose()})},this.distort=function(e,t,n,a,o,r,i){d(function(){e.distort(t,n,a,o,r,i)})},this.move=function(e,t,n,a,o){d(function(){e.move(t,n,a,o)})},this.shade=function(e,t){d(function(){e.shade(t)})},this.scale=function(e){o.style.transform=o.style.WebkitTransform=o.style.MozTransform=o.style.OTransform=o.style.msTransform="scale("+e+","+e+")",s.style.width=t*(a=e)+"px",s.style.height=n*a+"px"},this.getScale=function(){return a},this.flatten=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height;var t=e.getContext("2d");return function e(n,a,o){if(n.width>0&&n.height>0){var r=t.globalAlpha;t.globalAlpha*=n.alpha/255,t.drawImage(n.getCanvas(),a,o);for(var i=function(e){var t=[];for(var n in e.children)t.push(e.children[n]);return t.sort(function(e,t){var n=e.z-t.z;if(0!==n)return n;var a=e.getElement(),o=t.getElement().compareDocumentPosition(a);return o&Node.DOCUMENT_POSITION_PRECEDING?-1:o&Node.DOCUMENT_POSITION_FOLLOWING?1:0}),t}(n),s=0;s<i.length;s++){var u=i[s];e(u,a+u.x,o+u.y)}t.globalAlpha=r}}(r,0,0),e}},Guacamole.Display.VisibleLayer=function(e,t){Guacamole.Layer.apply(this,[e,t]);var n=this;this.__unique_id=Guacamole.Display.VisibleLayer.__next_id++,this.alpha=255,this.x=0,this.y=0,this.z=0,this.matrix=[1,0,0,1,0,0],this.parent=null,this.children={};var a=n.getCanvas();a.style.position="absolute",a.style.left="0px",a.style.top="0px";var o=document.createElement("div");o.appendChild(a),o.style.width=e+"px",o.style.height=t+"px",o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.overflow="hidden";var r=this.resize;this.resize=function(e,t){o.style.width=e+"px",o.style.height=t+"px",r(e,t)},this.getElement=function(){return o};var i="translate(0px, 0px)",s="matrix(1, 0, 0, 1, 0, 0)";this.translate=function(e,t){n.x=e,n.y=t,o.style.transform=o.style.WebkitTransform=o.style.MozTransform=o.style.OTransform=o.style.msTransform=(i="translate("+e+"px,"+t+"px)")+" "+s},this.move=function(e,t,a,r){n.parent!==e&&(n.parent&&delete n.parent.children[n.__unique_id],n.parent=e,e.children[n.__unique_id]=n,e.getElement().appendChild(o)),n.translate(t,a),n.z=r,o.style.zIndex=r},this.shade=function(e){n.alpha=e,o.style.opacity=e/255},this.dispose=function(){n.parent&&(delete n.parent.children[n.__unique_id],n.parent=null),o.parentNode&&o.parentNode.removeChild(o)},this.distort=function(e,t,a,r,u,c){n.matrix=[e,t,a,r,u,c],o.style.transform=o.style.WebkitTransform=o.style.MozTransform=o.style.OTransform=o.style.msTransform=i+" "+(s="matrix("+e+","+t+","+a+","+r+","+u+","+c+")")}},Guacamole.Display.VisibleLayer.__next_id=0,(Guacamole=Guacamole||{}).InputStream=function(e,t){var n=this;this.index=t,this.onblob=null,this.onend=null,this.sendAck=function(t,a){e.sendAck(n.index,t,a)}},(Guacamole=Guacamole||{}).IntegerPool=function(){var e=this,t=[];this.next_int=0,this.next=function(){return t.length>0?t.shift():e.next_int++},this.free=function(e){t.push(e)}},(Guacamole=Guacamole||{}).JSONReader=function(e){var t=this,n=new Guacamole.StringReader(e),a="";this.getLength=function(){return a.length},this.getJSON=function(){return JSON.parse(a)},n.ontext=function(e){a+=e,t.onprogress&&t.onprogress(e.length)},n.onend=function(){t.onend&&t.onend()},this.onprogress=null,this.onend=null},(Guacamole=Guacamole||{}).Keyboard=function(e){var t=this;this.onkeydown=null,this.onkeyup=null;var n=function(){var e=this;this.timestamp=(new Date).getTime(),this.defaultPrevented=!1,this.keysym=null,this.reliable=!1,this.getAge=function(){return(new Date).getTime()-e.timestamp}},a=function(e,a,o,r){n.apply(this),this.keyCode=e,this.keyIdentifier=a,this.key=o,this.location=r,this.keysym=g(o,r)||y(e,r),this.keysym&&!p(this.keysym)&&(this.reliable=!0),!this.keysym&&w(e,a)&&(this.keysym=g(a,r,t.modifiers.shift));var i=!(t.modifiers.ctrl||navigator&&navigator.platform&&navigator.platform.match(/^mac/i));(!t.modifiers.alt&&t.modifiers.ctrl||i&&t.modifiers.alt||t.modifiers.meta||t.modifiers.hyper)&&(this.reliable=!0),d[e]=this.keysym};a.prototype=new n;var o=function(e){n.apply(this),this.charCode=e,this.keysym=v(e),this.reliable=!0};o.prototype=new n;var r=function(e,t,a,o){n.apply(this),this.keyCode=e,this.keyIdentifier=t,this.key=a,this.location=o,this.keysym=d[e]||y(e,o)||g(a,o),this.reliable=!0};r.prototype=new n;var i=[],s={8:[65288],9:[65289],12:[65291,65291,65291,65461],13:[65293],16:[65505,65505,65506],17:[65507,65507,65508],18:[65513,65513,65027],19:[65299],20:[65509],27:[65307],32:[32],33:[65365,65365,65365,65465],34:[65366,65366,65366,65459],35:[65367,65367,65367,65457],36:[65360,65360,65360,65463],37:[65361,65361,65361,65460],38:[65362,65362,65362,65464],39:[65363,65363,65363,65462],40:[65364,65364,65364,65458],45:[65379,65379,65379,65456],46:[65535,65535,65535,65454],91:[65515],92:[65383],93:null,96:[65456],97:[65457],98:[65458],99:[65459],100:[65460],101:[65461],102:[65462],103:[65463],104:[65464],105:[65465],106:[65450],107:[65451],109:[65453],110:[65454],111:[65455],112:[65470],113:[65471],114:[65472],115:[65473],116:[65474],117:[65475],118:[65476],119:[65477],120:[65478],121:[65479],122:[65480],123:[65481],144:[65407],145:[65300],225:[65027]},u={Again:[65382],AllCandidates:[65341],Alphanumeric:[65328],Alt:[65513,65513,65027],Attn:[64782],AltGraph:[65027],ArrowDown:[65364],ArrowLeft:[65361],ArrowRight:[65363],ArrowUp:[65362],Backspace:[65288],CapsLock:[65509],Cancel:[65385],Clear:[65291],Convert:[65313],Copy:[64789],Crsel:[64796],CrSel:[64796],CodeInput:[65335],Compose:[65312],Control:[65507,65507,65508],ContextMenu:[65383],DeadGrave:[65104],DeadAcute:[65105],DeadCircumflex:[65106],DeadTilde:[65107],DeadMacron:[65108],DeadBreve:[65109],DeadAboveDot:[65110],DeadUmlaut:[65111],DeadAboveRing:[65112],DeadDoubleacute:[65113],DeadCaron:[65114],DeadCedilla:[65115],DeadOgonek:[65116],DeadIota:[65117],DeadVoicedSound:[65118],DeadSemivoicedSound:[65119],Delete:[65535],Down:[65364],End:[65367],Enter:[65293],EraseEof:[64774],Escape:[65307],Execute:[65378],Exsel:[64797],ExSel:[64797],F1:[65470],F2:[65471],F3:[65472],F4:[65473],F5:[65474],F6:[65475],F7:[65476],F8:[65477],F9:[65478],F10:[65479],F11:[65480],F12:[65481],F13:[65482],F14:[65483],F15:[65484],F16:[65485],F17:[65486],F18:[65487],F19:[65488],F20:[65489],F21:[65490],F22:[65491],F23:[65492],F24:[65493],Find:[65384],GroupFirst:[65036],GroupLast:[65038],GroupNext:[65032],GroupPrevious:[65034],FullWidth:null,HalfWidth:null,HangulMode:[65329],Hankaku:[65321],HanjaMode:[65332],Help:[65386],Hiragana:[65317],HiraganaKatakana:[65319],Home:[65360],Hyper:[65517,65517,65518],Insert:[65379],JapaneseHiragana:[65317],JapaneseKatakana:[65318],JapaneseRomaji:[65316],JunjaMode:[65336],KanaMode:[65325],KanjiMode:[65313],Katakana:[65318],Left:[65361],Meta:[65511,65511,65512],ModeChange:[65406],NumLock:[65407],PageDown:[65366],PageUp:[65365],Pause:[65299],Play:[64790],PreviousCandidate:[65342],PrintScreen:[64797],Redo:[65382],Right:[65363],RomanCharacters:null,Scroll:[65300],Select:[65376],Separator:[65452],Shift:[65505,65505,65506],SingleCandidate:[65340],Super:[65515,65515,65516],Tab:[65289],Up:[65362],Undo:[65381],Win:[65515],Zenkaku:[65320],ZenkakuHankaku:[65322]},c={65027:!0,65505:!0,65506:!0,65507:!0,65508:!0,65511:!0,65512:!0,65513:!0,65514:!0,65515:!0,65516:!0};this.modifiers=new Guacamole.Keyboard.ModifierState,this.pressed={};var l={},d={},h=null,f=null,m=function(e,t){return e?e[t]||e[0]:null},p=function(e){return e>=0&&e<=255||16777216==(4294901760&e)};function g(e,t,n){if(!e)return null;var a,o=e.indexOf("U+");if(o>=0){var r=e.substring(o+2);a=String.fromCharCode(parseInt(r,16))}else{if(1!==e.length||3===t)return m(u[e],t);a=e}return!0===n?a=a.toUpperCase():!1===n&&(a=a.toLowerCase()),v(a.charCodeAt(0))}function v(e){return function(e){return e<=31||e>=127&&e<=159}(e)?65280|e:e>=0&&e<=255?e:e>=256&&e<=1114111?16777216|e:null}function y(e,t){return m(s[e],t)}var w=function(e,t){if(!t)return!1;var n=t.indexOf("U+");return-1===n||e!==parseInt(t.substring(n+2),16)||e>=65&&e<=90||e>=48&&e<=57};this.press=function(e){if(null!==e){if(!t.pressed[e]&&(t.pressed[e]=!0,t.onkeydown)){var n=t.onkeydown(e);return l[e]=n,window.clearTimeout(h),window.clearInterval(f),c[e]||(h=window.setTimeout(function(){f=window.setInterval(function(){t.onkeyup(e),t.onkeydown(e)},50)},500)),n}return l[e]||!1}},this.release=function(e){t.pressed[e]&&(delete t.pressed[e],window.clearTimeout(h),window.clearInterval(f),null!==e&&t.onkeyup&&t.onkeyup(e))},this.reset=function(){for(var e in t.pressed)t.release(parseInt(e));i=[]};var S=function(e){var n=Guacamole.Keyboard.ModifierState.fromKeyboardEvent(e);t.modifiers.alt&&!1===n.alt&&(t.release(65513),t.release(65514),t.release(65027)),t.modifiers.shift&&!1===n.shift&&(t.release(65505),t.release(65506)),t.modifiers.ctrl&&!1===n.ctrl&&(t.release(65507),t.release(65508)),t.modifiers.meta&&!1===n.meta&&(t.release(65511),t.release(65512)),t.modifiers.hyper&&!1===n.hyper&&(t.release(65515),t.release(65516)),t.modifiers=n};function b(){var e,t=G();if(!t)return!1;do{e=t,t=G()}while(null!==t);return e.defaultPrevented}var G=function(){var e=i[0];if(!e)return null;if(!(e instanceof a))return e instanceof r?(n=e.keysym)?(t.release(n),e.defaultPrevented=!0,i.shift()):(t.reset(),e):i.shift();var n=null,s=[];if(e.reliable?(n=e.keysym,s=i.splice(0,1)):i[1]instanceof o?(n=i[1].keysym,s=i.splice(0,2)):i[1]&&(n=e.keysym,s=i.splice(0,1)),s.length>0){if(n){t.modifiers.ctrl&&t.modifiers.alt&&(n>=65&&n<=90||n>=97&&n<=122||(n<=255||16777216==(4278190080&n))&&(t.release(65507),t.release(65508),t.release(65513),t.release(65514)));var u=!t.press(n);d[e.keyCode]=n,t.modifiers.meta&&65511!==n&&65512!==n&&t.release(n);for(var c=0;c<s.length;c++)s[c].defaultPrevented=u}return e}return null},T=function(e){return"location"in e?e.location:"keyLocation"in e?e.keyLocation:0};e.addEventListener("keydown",function(e){var n;if(t.onkeydown&&(window.event?n=window.event.keyCode:e.which&&(n=e.which),S(e),229!==n)){var o=new a(n,e.keyIdentifier,e.key,T(e));i.push(o),b()&&e.preventDefault()}},!0),e.addEventListener("keypress",function(e){if(t.onkeydown||t.onkeyup){var n;window.event?n=window.event.keyCode:e.which&&(n=e.which),S(e);var a=new o(n);i.push(a),b()&&e.preventDefault()}},!0),e.addEventListener("keyup",function(e){if(t.onkeyup){var n;e.preventDefault(),window.event?n=window.event.keyCode:e.which&&(n=e.which),S(e);var a=new r(n,e.keyIdentifier,e.key,T(e));i.push(a),b()}},!0)},Guacamole.Keyboard.ModifierState=function(){this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.hyper=!1},Guacamole.Keyboard.ModifierState.fromKeyboardEvent=function(e){var t=new Guacamole.Keyboard.ModifierState;return t.shift=e.shiftKey,t.ctrl=e.ctrlKey,t.alt=e.altKey,t.meta=e.metaKey,e.getModifierState&&(t.hyper=e.getModifierState("OS")||e.getModifierState("Super")||e.getModifierState("Hyper")||e.getModifierState("Win")),t},(Guacamole=Guacamole||{}).Layer=function(e,t){var n=this,a=document.createElement("canvas"),o=a.getContext("2d");o.save();var r=!0,i=!0,s=0,u={1:"destination-in",2:"destination-out",4:"source-in",6:"source-atop",8:"source-out",9:"destination-atop",10:"xor",11:"destination-over",12:"copy",14:"source-over",15:"lighter"},c=function(e,t){e=e||0,t=t||0;var i=64*Math.ceil(e/64),u=64*Math.ceil(t/64);if(a.width!==i||a.height!==u){var c=null;r||0===a.width||0===a.height||((c=document.createElement("canvas")).width=Math.min(n.width,e),c.height=Math.min(n.height,t),c.getContext("2d").drawImage(a,0,0,c.width,c.height,0,0,c.width,c.height));var l=o.globalCompositeOperation;a.width=i,a.height=u,c&&o.drawImage(c,0,0,c.width,c.height,0,0,c.width,c.height),o.globalCompositeOperation=l,s=0,o.save()}else n.reset();n.width=e,n.height=t};function l(e,t,a,o){var r=a+e,i=o+t;n.resize(r>n.width?r:n.width,i>n.height?i:n.height)}this.autosize=!1,this.width=e,this.height=t,this.getCanvas=function(){return a},this.toCanvas=function(){var e=document.createElement("canvas");return e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n.getCanvas(),0,0),e},this.resize=function(e,t){e===n.width&&t===n.height||c(e,t)},this.drawImage=function(e,t,a){n.autosize&&l(e,t,a.width,a.height),o.drawImage(a,e,t),r=!1},this.transfer=function(e,t,a,i,s,u,c,d){var h=e.getCanvas();if(!(t>=h.width||a>=h.height)&&(t+i>h.width&&(i=h.width-t),a+s>h.height&&(s=h.height-a),0!==i&&0!==s)){n.autosize&&l(u,c,i,s);for(var f=e.getCanvas().getContext("2d").getImageData(t,a,i,s),m=o.getImageData(u,c,i,s),p=0;p<i*s*4;p+=4){var g=new Guacamole.Layer.Pixel(f.data[p],f.data[p+1],f.data[p+2],f.data[p+3]),v=new Guacamole.Layer.Pixel(m.data[p],m.data[p+1],m.data[p+2],m.data[p+3]);d(g,v),m.data[p]=v.red,m.data[p+1]=v.green,m.data[p+2]=v.blue,m.data[p+3]=v.alpha}o.putImageData(m,u,c),r=!1}},this.put=function(e,t,a,i,s,u,c){var d=e.getCanvas();if(!(t>=d.width||a>=d.height)&&(t+i>d.width&&(i=d.width-t),a+s>d.height&&(s=d.height-a),0!==i&&0!==s)){n.autosize&&l(u,c,i,s);var h=e.getCanvas().getContext("2d").getImageData(t,a,i,s);o.putImageData(h,u,c),r=!1}},this.copy=function(e,t,a,i,s,u,c){var d=e.getCanvas();t>=d.width||a>=d.height||(t+i>d.width&&(i=d.width-t),a+s>d.height&&(s=d.height-a),0!==i&&0!==s&&(n.autosize&&l(u,c,i,s),o.drawImage(d,t,a,i,s,u,c,i,s),r=!1))},this.moveTo=function(e,t){i&&(o.beginPath(),i=!1),n.autosize&&l(e,t,0,0),o.moveTo(e,t)},this.lineTo=function(e,t){i&&(o.beginPath(),i=!1),n.autosize&&l(e,t,0,0),o.lineTo(e,t)},this.arc=function(e,t,a,r,s,u){i&&(o.beginPath(),i=!1),n.autosize&&l(e,t,0,0),o.arc(e,t,a,r,s,u)},this.curveTo=function(e,t,a,r,s,u){i&&(o.beginPath(),i=!1),n.autosize&&l(s,u,0,0),o.bezierCurveTo(e,t,a,r,s,u)},this.close=function(){o.closePath(),i=!0},this.rect=function(e,t,a,r){i&&(o.beginPath(),i=!1),n.autosize&&l(e,t,a,r),o.rect(e,t,a,r)},this.clip=function(){o.clip(),i=!0},this.strokeColor=function(e,t,n,a,s,u,c){o.lineCap=e,o.lineJoin=t,o.lineWidth=n,o.strokeStyle="rgba("+a+","+s+","+u+","+c/255+")",o.stroke(),r=!1,i=!0},this.fillColor=function(e,t,n,a){o.fillStyle="rgba("+e+","+t+","+n+","+a/255+")",o.fill(),r=!1,i=!0},this.strokeLayer=function(e,t,n,a){o.lineCap=e,o.lineJoin=t,o.lineWidth=n,o.strokeStyle=o.createPattern(a.getCanvas(),"repeat"),o.stroke(),r=!1,i=!0},this.fillLayer=function(e){o.fillStyle=o.createPattern(e.getCanvas(),"repeat"),o.fill(),r=!1,i=!0},this.push=function(){o.save(),s++},this.pop=function(){s>0&&(o.restore(),s--)},this.reset=function(){for(;s>0;)o.restore(),s--;o.restore(),o.save(),o.beginPath(),i=!1},this.setTransform=function(e,t,n,a,r,i){o.setTransform(e,t,n,a,r,i)},this.transform=function(e,t,n,a,r,i){o.transform(e,t,n,a,r,i)},this.setChannelMask=function(e){o.globalCompositeOperation=u[e]},this.setMiterLimit=function(e){o.miterLimit=e},c(e,t),a.style.zIndex=-1},Guacamole.Layer.ROUT=2,Guacamole.Layer.ATOP=6,Guacamole.Layer.XOR=10,Guacamole.Layer.ROVER=11,Guacamole.Layer.OVER=14,Guacamole.Layer.PLUS=15,Guacamole.Layer.RIN=1,Guacamole.Layer.IN=4,Guacamole.Layer.OUT=8,Guacamole.Layer.RATOP=9,Guacamole.Layer.SRC=12,Guacamole.Layer.Pixel=function(e,t,n,a){this.red=e,this.green=t,this.blue=n,this.alpha=a},(Guacamole=Guacamole||{}).Mouse=function(e){var t=this;this.touchMouseThreshold=3,this.scrollThreshold=53,this.PIXELS_PER_LINE=18,this.PIXELS_PER_PAGE=16*this.PIXELS_PER_LINE,this.currentState=new Guacamole.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null,this.onmouseout=null;var n=0,a=0;function o(e){e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function r(){n=t.touchMouseThreshold}function i(e){var n=e.deltaY||-e.wheelDeltaY||-e.wheelDelta;if(n?1===e.deltaMode?n=e.deltaY*t.PIXELS_PER_LINE:2===e.deltaMode&&(n=e.deltaY*t.PIXELS_PER_PAGE):n=e.detail*t.PIXELS_PER_LINE,(a+=n)<=-t.scrollThreshold){do{t.onmousedown&&(t.currentState.up=!0,t.onmousedown(t.currentState)),t.onmouseup&&(t.currentState.up=!1,t.onmouseup(t.currentState)),a+=t.scrollThreshold}while(a<=-t.scrollThreshold);a=0}if(a>=t.scrollThreshold){do{t.onmousedown&&(t.currentState.down=!0,t.onmousedown(t.currentState)),t.onmouseup&&(t.currentState.down=!1,t.onmouseup(t.currentState)),a-=t.scrollThreshold}while(a>=t.scrollThreshold);a=0}o(e)}e.addEventListener("contextmenu",function(e){o(e)},!1),e.addEventListener("mousemove",function(a){o(a),n?n--:(t.currentState.fromClientPosition(e,a.clientX,a.clientY),t.onmousemove&&t.onmousemove(t.currentState))},!1),e.addEventListener("mousedown",function(e){if(o(e),!n){switch(e.button){case 0:t.currentState.left=!0;break;case 1:t.currentState.middle=!0;break;case 2:t.currentState.right=!0}t.onmousedown&&t.onmousedown(t.currentState)}},!1),e.addEventListener("mouseup",function(e){if(o(e),!n){switch(e.button){case 0:t.currentState.left=!1;break;case 1:t.currentState.middle=!1;break;case 2:t.currentState.right=!1}t.onmouseup&&t.onmouseup(t.currentState)}},!1),e.addEventListener("mouseout",function(n){n||(n=window.event);for(var a=n.relatedTarget||n.toElement;a;){if(a===e)return;a=a.parentNode}o(n),(t.currentState.left||t.currentState.middle||t.currentState.right)&&(t.currentState.left=!1,t.currentState.middle=!1,t.currentState.right=!1,t.onmouseup&&t.onmouseup(t.currentState)),t.onmouseout&&t.onmouseout()},!1),e.addEventListener("selectstart",function(e){o(e)},!1),e.addEventListener("touchmove",r,!1),e.addEventListener("touchstart",r,!1),e.addEventListener("touchend",r,!1),e.addEventListener("DOMMouseScroll",i,!1),e.addEventListener("mousewheel",i,!1),e.addEventListener("wheel",i,!1);var s=function(){var e=document.createElement("div");if(!("cursor"in e.style))return!1;try{e.style.cursor="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEX///+nxBvIAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==) 0 0, auto"}catch(e){return!1}return/\burl\([^()]*\)\s+0\s+0\b/.test(e.style.cursor||"")}();this.setCursor=function(t,n,a){if(s){var o=t.toDataURL("image/png");return e.style.cursor="url("+o+") "+n+" "+a+", auto",!0}return!1}},Guacamole.Mouse.State=function(e,t,n,a,o,r,i){var s=this;this.x=e,this.y=t,this.left=n,this.middle=a,this.right=o,this.up=r,this.down=i,this.fromClientPosition=function(e,t,n){s.x=t-e.offsetLeft,s.y=n-e.offsetTop;for(var a=e.offsetParent;a&&a!==document.body;)s.x-=a.offsetLeft-a.scrollLeft,s.y-=a.offsetTop-a.scrollTop,a=a.offsetParent;if(a){var o=document.body.scrollLeft||document.documentElement.scrollLeft,r=document.body.scrollTop||document.documentElement.scrollTop;s.x-=a.offsetLeft-o,s.y-=a.offsetTop-r}}},Guacamole.Mouse.Touchpad=function(e){var t=this;this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=10*(window.devicePixelRatio||1),this.currentState=new Guacamole.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null;var n=0,a=0,o=0,r=0,i=0,s={1:"left",2:"right",3:"middle"},u=!1,c=null;e.addEventListener("touchend",function(e){if(e.preventDefault(),u&&0===e.touches.length){var a=(new Date).getTime(),o=s[n];t.currentState[o]&&(t.currentState[o]=!1,t.onmouseup&&t.onmouseup(t.currentState),c&&(window.clearTimeout(c),c=null)),a-r<=t.clickTimingThreshold&&i<t.clickMoveThreshold&&(t.currentState[o]=!0,t.onmousedown&&t.onmousedown(t.currentState),c=window.setTimeout(function(){t.currentState[o]=!1,t.onmouseup&&t.onmouseup(t.currentState),u=!1},t.clickTimingThreshold)),c||(u=!1)}},!1),e.addEventListener("touchstart",function(e){if(e.preventDefault(),n=Math.min(e.touches.length,3),c&&(window.clearTimeout(c),c=null),!u){u=!0;var t=e.touches[0];a=t.clientX,o=t.clientY,r=(new Date).getTime(),i=0}},!1),e.addEventListener("touchmove",function(s){s.preventDefault();var u=s.touches[0],c=u.clientX-a,l=u.clientY-o;if(i+=Math.abs(c)+Math.abs(l),1===n){var d=1+i/((new Date).getTime()-r);t.currentState.x+=c*d,t.currentState.y+=l*d,t.currentState.x<0?t.currentState.x=0:t.currentState.x>=e.offsetWidth&&(t.currentState.x=e.offsetWidth-1),t.currentState.y<0?t.currentState.y=0:t.currentState.y>=e.offsetHeight&&(t.currentState.y=e.offsetHeight-1),t.onmousemove&&t.onmousemove(t.currentState),a=u.clientX,o=u.clientY}else{var h;2===n&&Math.abs(l)>=t.scrollThreshold&&(t.currentState[h=l>0?"down":"up"]=!0,t.onmousedown&&t.onmousedown(t.currentState),t.currentState[h]=!1,t.onmouseup&&t.onmouseup(t.currentState),a=u.clientX,o=u.clientY)}},!1)},Guacamole.Mouse.Touchscreen=function(e){var t=this,n=!1,a=null,o=null,r=null,i=null;function s(e){t.currentState[e]||(t.currentState[e]=!0,t.onmousedown&&t.onmousedown(t.currentState))}function u(e){t.currentState[e]&&(t.currentState[e]=!1,t.onmouseup&&t.onmouseup(t.currentState))}function c(n,a){t.currentState.fromClientPosition(e,n,a),t.onmousemove&&t.onmousemove(t.currentState)}function l(e){var n=e.touches[0]||e.changedTouches[0],r=n.clientX-a,i=n.clientY-o;return Math.sqrt(r*r+i*i)>=t.clickMoveThreshold}function d(){window.clearTimeout(r),window.clearTimeout(i),n=!1}this.scrollThreshold=20*(window.devicePixelRatio||1),this.clickTimingThreshold=250,this.clickMoveThreshold=16*(window.devicePixelRatio||1),this.longPressThreshold=500,this.currentState=new Guacamole.Mouse.State(0,0,!1,!1,!1,!1,!1),this.onmousedown=null,this.onmouseup=null,this.onmousemove=null,e.addEventListener("touchend",function(e){if(n)if(0===e.touches.length&&1===e.changedTouches.length){if(window.clearTimeout(i),u("left"),!l(e)&&(e.preventDefault(),!t.currentState.left)){var a=e.changedTouches[0];c(a.clientX,a.clientY),s("left"),r=window.setTimeout(function(){u("left"),d()},t.clickTimingThreshold)}}else d()},!1),e.addEventListener("touchstart",function(e){1===e.touches.length?(e.preventDefault(),function(e){var t=e.touches[0];n=!0,a=t.clientX,o=t.clientY}(e),window.clearTimeout(r),i=window.setTimeout(function(){var t=e.touches[0];c(t.clientX,t.clientY),function(e){s(e),u(e)}("right"),d()},t.longPressThreshold)):d()},!1),e.addEventListener("touchmove",function(e){if(n)if(l(e)&&window.clearTimeout(i),1===e.touches.length){if(t.currentState.left){e.preventDefault();var a=e.touches[0];c(a.clientX,a.clientY)}}else d()},!1)},(Guacamole=(Guacamole=Guacamole||{})||{}).Object=function(e,t){var n=this,a={};this.index=t,this.onbody=function(e,t,n){var o=function(e){var t=a[e];if(!t)return null;var n=t.shift();return 0===t.length&&delete a[e],n}(n);o&&o(e,t)},this.onundefine=null,this.requestInputStream=function(t,o){o&&function(e,t){var n=a[e];n||(a[e]=n=[]),n.push(t)}(t,o),e.requestObjectInputStream(n.index,t)},this.createOutputStream=function(t,a){return e.createObjectOutputStream(n.index,t,a)}},Guacamole.Object.ROOT_STREAM="/",Guacamole.Object.STREAM_INDEX_MIMETYPE="application/vnd.glyptodon.guacamole.stream-index+json",(Guacamole=Guacamole||{}).OnScreenKeyboard=function(e){var t=this,n={},a={},o=[],r=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},i=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(/([^ ]+)[ ]*/g,function(e,n){return n===t?"":e})},s=0,u=function(e,t,n,a){this.width=t,this.height=n,this.scale=function(o){e.style.width=t*o+"px",e.style.height=n*o+"px",a&&(e.style.lineHeight=n*o+"px",e.style.fontSize=o+"px")}},c=function(e){for(var t=0;t<e.length;t++)if(!(e[t]in n))return!1;return!0},l=function(e){var n=t.keys[e];if(!n)return null;for(var a=n.length-1;a>=0;a--){var o=n[a];if(c(o.requires))return o}return null},d=function(e,o){if(!a[e]){r(o,"guac-keyboard-pressed");var s=l(e);if(s.modifier){var u="guac-keyboard-modifier-"+p(s.modifier),c=n[s.modifier];c?(i(f,u),delete n[s.modifier],t.onkeyup&&t.onkeyup(c)):(r(f,u),n[s.modifier]=s.keysym,t.onkeydown&&t.onkeydown(s.keysym))}else t.onkeydown&&t.onkeydown(s.keysym);a[e]=!0}},h=function(e,n){if(a[e]){i(n,"guac-keyboard-pressed");var o=l(e);!o.modifier&&t.onkeyup&&t.onkeyup(o.keysym),a[e]=!1}},f=document.createElement("div");f.className="guac-keyboard",f.onselectstart=f.onmousemove=f.onmouseup=f.onmousedown=function(e){return s&&s--,e.stopPropagation(),!1},this.touchMouseThreshold=3,this.onkeydown=null,this.onkeyup=null,this.layout=new Guacamole.OnScreenKeyboard.Layout(e),this.getElement=function(){return f},this.resize=function(e){for(var n=Math.floor(10*e/t.layout.width)/10,a=0;a<o.length;a++)o[a].scale(n)};var m=function(e,t){if(t instanceof Array){for(var n=[],a=0;a<t.length;a++)n.push(new Guacamole.OnScreenKeyboard.Key(t[a],e));return n}return"number"==typeof t?[new Guacamole.OnScreenKeyboard.Key({name:e,keysym:t})]:"string"==typeof t?[new Guacamole.OnScreenKeyboard.Key({name:e,title:t})]:[new Guacamole.OnScreenKeyboard.Key(t,e)]};this.keys=function(t){var n={};for(var a in e.keys)n[a]=m(a,t[a]);return n}(e.keys);var p=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[^A-Za-z0-9]+/g,"-").toLowerCase()};!function e(n,a,i){var c,l=document.createElement("div");if(i&&r(l,"guac-keyboard-"+p(i)),a instanceof Array)for(r(l,"guac-keyboard-group"),c=0;c<a.length;c++)e(l,a[c]);else if(a instanceof Object){r(l,"guac-keyboard-group");var f=Object.keys(a).sort();for(c=0;c<f.length;c++)e(l,a[i=f[c]],i)}else if("number"==typeof a)r(l,"guac-keyboard-gap"),o.push(new u(l,a,a));else if("string"==typeof a){var m=a;1===m.length&&(m="0x"+m.charCodeAt(0).toString(16)),r(l,"guac-keyboard-key-container");var g=document.createElement("div");g.className="guac-keyboard-key guac-keyboard-key-"+p(m);var v=t.keys[a];if(v)for(c=0;c<v.length;c++){var y=v[c],w=document.createElement("div");w.className="guac-keyboard-cap",w.textContent=y.title;for(var S=0;S<y.requires.length;S++){var b=y.requires[S];r(w,"guac-keyboard-requires-"+p(b)),r(g,"guac-keyboard-uses-"+p(b))}g.appendChild(w)}l.appendChild(g),o.push(new u(l,t.layout.keyWidths[a]||1,1,!0));var G=function(e){e.preventDefault(),0===s&&h(a,g)};g.addEventListener("touchstart",function(e){e.preventDefault(),s=t.touchMouseThreshold,d(a,g)},!0),g.addEventListener("touchend",function(e){e.preventDefault(),s=t.touchMouseThreshold,h(a,g)},!0),g.addEventListener("mousedown",function(e){e.preventDefault(),0===s&&d(a,g)},!0),g.addEventListener("mouseup",G,!0),g.addEventListener("mouseout",G,!0)}n.appendChild(l)}(f,e.layout)},Guacamole.OnScreenKeyboard.Layout=function(e){this.language=e.language,this.type=e.type,this.keys=e.keys,this.layout=e.layout,this.width=e.width,this.keyWidths=e.keyWidths||{}},Guacamole.OnScreenKeyboard.Key=function(e,t){this.name=t||e.name,this.title=e.title||this.name,this.keysym=e.keysym||function(e){if(!e||1!==e.length)return null;var t=e.charCodeAt(0);return t>=0&&t<=255?t:t>=256&&t<=1114111?16777216|t:null}(this.title),this.modifier=e.modifier,this.requires=e.requires||[]},(Guacamole=Guacamole||{}).OutputStream=function(e,t){var n=this;this.index=t,this.onack=null,this.sendBlob=function(t){e.sendBlob(n.index,t)},this.sendEnd=function(){e.endStream(n.index)}},(Guacamole=Guacamole||{}).Parser=function(){var e=this,t="",n=[],a=-1,o=0;this.receive=function(r){for(o>4096&&a>=o&&(t=t.substring(o),a-=o,o=0),t+=r;a<t.length;){if(a>=o){var i=t.substring(o,a),s=t.substring(a,a+1);if(n.push(i),";"==s){var u=n.shift();null!=e.oninstruction&&e.oninstruction(u,n),n.length=0}else if(","!=s)throw new Error("Illegal terminator.");o=a+1}var c=t.indexOf(".",o);if(-1==c){o=t.length;break}var l=parseInt(t.substring(a+1,c));if(isNaN(l))throw new Error("Non-numeric character in element length.");a=(o=c+1)+l}},this.oninstruction=null},(Guacamole=Guacamole||{}).RawAudioFormat=function(e){this.bytesPerSample=e.bytesPerSample,this.channels=e.channels,this.rate=e.rate},Guacamole.RawAudioFormat.parse=function(e){var t,n=null,a=1;if("audio/L8;"===e.substring(0,9))e=e.substring(9),t=1;else{if("audio/L16;"!==e.substring(0,10))return null;e=e.substring(10),t=2}for(var o=e.split(","),r=0;r<o.length;r++){var i=o[r],s=i.indexOf("=");if(-1===s)return null;var u=i.substring(0,s),c=i.substring(s+1);switch(u){case"channels":a=parseInt(c);break;case"rate":n=parseInt(c);break;default:return null}}return null===n?null:new Guacamole.RawAudioFormat({bytesPerSample:t,channels:a,rate:n})},(Guacamole=Guacamole||{}).SessionRecording=function(e){var t=this,n=[],a=[],o=0,r=0,i=new Guacamole.SessionRecording._PlaybackTunnel,s=new Guacamole.Client(i),u=-1,c=null,l=null,d=null;s.connect(),s.getDisplay().showCursor(!1),e.oninstruction=function(e,i){var s=new Guacamole.SessionRecording._Frame.Instruction(e,i.slice());if(a.push(s),o+=s.getSize(),"sync"===e){var u=parseInt(i[0]),c=new Guacamole.SessionRecording._Frame(u,a);n.push(c),(1===n.length||o>=16384&&u-r>=5e3)&&(c.keyframe=!0,r=u,o=0),a=[],t.onprogress&&t.onprogress(t.getDuration())}};var h=function(e){return 0===n.length?0:e-n[0].timestamp},f=function(e){for(var t=n[e],a=0;a<t.instructions.length;a++){var o=t.instructions[a];i.receiveInstruction(o.opcode,o.args)}t.keyframe&&!t.clientState&&s.exportState(function(e){t.clientState=e})},m=function e(a,o,r){p(),d=window.setTimeout(function(){var i;for(i=a;i>=0;i--){var c=n[i];if(i===u)break;if(c.clientState){s.importState(c.clientState);break}}i++;for(var l=(new Date).getTime();i<=a&&!((new Date).getTime()-l>=5);i++)f(i);u=i-1,t.onseek&&t.onseek(t.getPosition()),u!==a?e(a,o,Math.max(r-((new Date).getTime()-l),0)):o()},r||0)},p=function(){window.clearTimeout(d)};this.onprogress=null,this.onplay=null,this.onpause=null,this.onseek=null,this.connect=function(t){e.connect(t)},this.disconnect=function(){e.disconnect()},this.getDisplay=function(){return s.getDisplay()},this.isPlaying=function(){return!!c},this.getPosition=function(){return-1===u?0:h(n[u].timestamp)},this.getDuration=function(){return 0===n.length?0:h(n[n.length-1].timestamp)},this.play=function(){!t.isPlaying()&&u+1<n.length&&(t.onplay&&t.onplay(),c=n[u+1].timestamp,l=(new Date).getTime(),function e(){if(u+1<n.length){var a=Math.max(n[u+1].timestamp-c+l-(new Date).getTime(),0);m(u+1,function(){e()},a)}else t.pause()}())},this.seek=function(e,a){if(0!==n.length){var o=t.isPlaying();t.pause(),m(function e(t,a,o){if(t===a)return t;var r=Math.floor((t+a)/2),i=h(n[r].timestamp);return o<i&&r>t?e(t,r-1,o):o>i&&r<a?e(r+1,a,o):r}(0,n.length-1,e),function(){o&&t.play(),a&&a()})}},this.pause=function(){p(),t.isPlaying()&&(t.onpause&&t.onpause(),c=null,l=null)}},Guacamole.SessionRecording._Frame=function(e,t){this.keyframe=!1,this.timestamp=e,this.instructions=t,this.clientState=null},Guacamole.SessionRecording._Frame.Instruction=function(e,t){var n=this;this.opcode=e,this.args=t,this.getSize=function(){for(var e=n.opcode.length,t=0;t<n.args.length;t++)e+=n.args[t].length;return e}},Guacamole.SessionRecording._PlaybackTunnel=function(){var e=this;this.connect=function(e){},this.sendMessage=function(e){},this.disconnect=function(){},this.receiveInstruction=function(t,n){e.oninstruction&&e.oninstruction(t,n)}},(Guacamole=Guacamole||{}).Status=function(e,t){var n=this;this.code=e,this.message=t,this.isError=function(){return n.code<0||n.code>255}},Guacamole.Status.Code={SUCCESS:0,UNSUPPORTED:256,SERVER_ERROR:512,SERVER_BUSY:513,UPSTREAM_TIMEOUT:514,UPSTREAM_ERROR:515,RESOURCE_NOT_FOUND:516,RESOURCE_CONFLICT:517,RESOURCE_CLOSED:518,UPSTREAM_NOT_FOUND:519,UPSTREAM_UNAVAILABLE:520,SESSION_CONFLICT:521,SESSION_TIMEOUT:522,SESSION_CLOSED:523,CLIENT_BAD_REQUEST:768,CLIENT_UNAUTHORIZED:769,CLIENT_FORBIDDEN:771,CLIENT_TIMEOUT:776,CLIENT_OVERRUN:781,CLIENT_BAD_TYPE:783,CLIENT_TOO_MANY:797},(Guacamole=Guacamole||{}).StringReader=function(e){var t=this,n=new Guacamole.ArrayBufferReader(e),a=0,o=0;n.ondata=function(e){var n=function(e){for(var t="",n=new Uint8Array(e),r=0;r<n.length;r++){var i=n[r];0===a?127==(127|i)?t+=String.fromCharCode(i):223==(31|i)?(o=31&i,a=1):239==(15|i)?(o=15&i,a=2):247==(7|i)?(o=7&i,a=3):t+="\ufffd":191==(63|i)?(o=o<<6|63&i,0==--a&&(t+=String.fromCharCode(o))):(a=0,t+="\ufffd")}return t}(e);t.ontext&&t.ontext(n)},n.onend=function(){t.onend&&t.onend()},this.ontext=null,this.onend=null},(Guacamole=Guacamole||{}).StringWriter=function(e){var t=this,n=new Guacamole.ArrayBufferWriter(e),a=new Uint8Array(8192),o=0;function r(e){var t,n;if(e<=127)t=0,n=1;else if(e<=2047)t=192,n=2;else if(e<=65535)t=224,n=3;else{if(!(e<=2097151))return void r(65533);t=240,n=4}!function(e){if(o+e>=a.length){var t=new Uint8Array(2*(o+e));t.set(a),a=t}o+=e}(n);for(var i=o-1,s=1;s<n;s++)a[i--]=128|63&e,e>>=6;a[i]=t|e}n.onack=function(e){t.onack&&t.onack(e)},this.sendText=function(e){e.length&&n.sendData(function(e){for(var t=0;t<e.length;t++)r(e.charCodeAt(t));if(o>0){var n=a.subarray(0,o);return o=0,n}}(e))},this.sendEnd=function(){n.sendEnd()},this.onack=null},(Guacamole=Guacamole||{}).Tunnel=function(){this.connect=function(e){},this.disconnect=function(){},this.sendMessage=function(e){},this.state=Guacamole.Tunnel.State.CONNECTING,this.receiveTimeout=15e3,this.uuid=null,this.onerror=null,this.onstatechange=null,this.oninstruction=null},Guacamole.Tunnel.INTERNAL_DATA_OPCODE="",Guacamole.Tunnel.State={CONNECTING:0,OPEN:1,CLOSED:2},Guacamole.HTTPTunnel=function(e,t){var n=this,a=e+"?connect",o=e+"?read:",r=e+"?write:",i=1,s=i,u=!1,c="",l=!!t,d=null;function h(){window.clearTimeout(d),d=window.setTimeout(function(){f(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},n.receiveTimeout)}function f(e){n.state!==Guacamole.Tunnel.State.CLOSED&&(e.code!==Guacamole.Status.Code.SUCCESS&&n.onerror&&(n.state!==Guacamole.Tunnel.State.CONNECTING&&e.code===Guacamole.Status.Code.RESOURCE_NOT_FOUND||n.onerror(e)),n.state=Guacamole.Tunnel.State.CLOSED,u=!1,n.onstatechange&&n.onstatechange(n.state))}function m(e){var t=parseInt(e.getResponseHeader("Guacamole-Status-Code")),n=e.getResponseHeader("Guacamole-Error-Message");f(new Guacamole.Status(t,n))}this.sendMessage=function(){if(n.state===Guacamole.Tunnel.State.OPEN&&0!==arguments.length){for(var e=a(arguments[0]),t=1;t<arguments.length;t++)e+=","+a(arguments[t]);c+=e+=";",u||function e(){if(n.state===Guacamole.Tunnel.State.OPEN)if(c.length>0){u=!0;var t=new XMLHttpRequest;t.open("POST",r+n.uuid),t.withCredentials=l,t.setRequestHeader("Content-type","application/octet-stream"),t.onreadystatechange=function(){4===t.readyState&&(200!==t.status?m(t):e())},t.send(c),c=""}else u=!1}()}function a(e){var t=new String(e);return t.length+"."+t}};var p=0;function g(){var e=new XMLHttpRequest;return e.open("GET",o+n.uuid+":"+p++),e.withCredentials=l,e.send(null),e}this.connect=function(e){h();var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&(200===t.status?(h(),n.uuid=t.responseText,n.state=Guacamole.Tunnel.State.OPEN,n.onstatechange&&n.onstatechange(n.state),function e(t){var a=null,o=null,r=0,u=-1,c=0,l=new Array;function d(){if(n.state===Guacamole.Tunnel.State.OPEN){if(!(t.readyState<2)){var r;try{r=t.status}catch(e){r=200}if(o||200!==r||(o=g()),3===t.readyState||4===t.readyState){if(h(),s===i&&(3!==t.readyState||a?4===t.readyState&&a&&clearInterval(a):a=setInterval(d,30)),0===t.status)return void n.disconnect();if(200!==t.status)return void m(t);var f;try{f=t.responseText}catch(e){return}for(;u<f.length;){if(u>=c){var p=f.substring(c,u),v=f.substring(u,u+1);if(l.push(p),";"===v){var y=l.shift();n.oninstruction&&n.oninstruction(y,l),l.length=0}c=u+1}var w=f.indexOf(".",c);if(-1===w){c=f.length;break}var S=parseInt(f.substring(u+1,w));if(0===S){a&&clearInterval(a),t.onreadystatechange=null,t.abort(),o&&e(o);break}u=(c=w+1)+S}}}}else null!==a&&clearInterval(a)}t.onreadystatechange=s===i?function(){3===t.readyState&&++r>=2&&(s=0,t.onreadystatechange=d),d()}:d,d()}(g())):m(t))},t.open("POST",a,!0),t.withCredentials=l,t.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),t.send(e)},this.disconnect=function(){f(new Guacamole.Status(Guacamole.Status.Code.SUCCESS,"Manually closed."))}},Guacamole.HTTPTunnel.prototype=new Guacamole.Tunnel,Guacamole.WebSocketTunnel=function(e){var t=this,n=null,a=null;if("ws:"!==e.substring(0,3)&&"wss:"!==e.substring(0,4)){var o={"http:":"ws:","https:":"wss:"}[window.location.protocol];if("/"===e.substring(0,1))e=o+"//"+window.location.host+e;else{var r=window.location.pathname.lastIndexOf("/"),i=window.location.pathname.substring(0,r+1);e=o+"//"+window.location.host+i+e}}function s(){window.clearTimeout(a),a=window.setTimeout(function(){u(new Guacamole.Status(Guacamole.Status.Code.UPSTREAM_TIMEOUT,"Server timeout."))},t.receiveTimeout)}function u(e){t.state!==Guacamole.Tunnel.State.CLOSED&&(e.code!==Guacamole.Status.Code.SUCCESS&&t.onerror&&t.onerror(e),t.state=Guacamole.Tunnel.State.CLOSED,t.onstatechange&&t.onstatechange(t.state),n.close())}this.sendMessage=function(e){if(t.state===Guacamole.Tunnel.State.OPEN&&0!==arguments.length){for(var a=r(arguments[0]),o=1;o<arguments.length;o++)a+=","+r(arguments[o]);n.send(a+=";")}function r(e){var t=new String(e);return t.length+"."+t}},this.connect=function(a){s(),(n=new WebSocket(e+"?"+a,"guacamole")).onopen=function(e){s()},n.onclose=function(e){u(new Guacamole.Status(parseInt(e.reason),e.reason))},n.onerror=function(e){u(new Guacamole.Status(Guacamole.Status.Code.SERVER_ERROR,e.data))},n.onmessage=function(e){s();var n,a=e.data,o=0,r=[];do{var i=a.indexOf(".",o);-1!==i?n=(o=i+1)+parseInt(a.substring(n+1,i)):u(new Guacamole.Status(Guacamole.Status.Code.SERVER_ERROR,"Incomplete instruction."));var c=a.substring(o,n),l=a.substring(n,n+1);if(r.push(c),";"===l){var d=r.shift();t.state!==Guacamole.Tunnel.State.OPEN&&(d===Guacamole.Tunnel.INTERNAL_DATA_OPCODE&&(t.uuid=r[0]),t.state=Guacamole.Tunnel.State.OPEN,t.onstatechange&&t.onstatechange(t.state)),d!==Guacamole.Tunnel.INTERNAL_DATA_OPCODE&&t.oninstruction&&t.oninstruction(d,r),r.length=0}o=n+1}while(o<a.length)}},this.disconnect=function(){u(new Guacamole.Status(Guacamole.Status.Code.SUCCESS,"Manually closed."))}},Guacamole.WebSocketTunnel.prototype=new Guacamole.Tunnel,Guacamole.ChainedTunnel=function(e){for(var t,n=this,a=[],o=null,r=0;r<arguments.length;r++)a.push(arguments[r]);this.connect=function(e){t=e;var r=o||a.shift();r?function e(r){n.disconnect=r.disconnect,n.sendMessage=r.sendMessage;var i=function(t){if(t&&t.code===Guacamole.Status.Code.UPSTREAM_TIMEOUT)return a=[],null;var n=a.shift();return n&&(r.onerror=null,r.oninstruction=null,r.onstatechange=null,e(n)),n};function s(){r.onstatechange=n.onstatechange,r.oninstruction=n.oninstruction,r.onerror=n.onerror,n.uuid=r.uuid,o=r}r.onstatechange=function(e){switch(e){case Guacamole.Tunnel.State.OPEN:s(),n.onstatechange&&n.onstatechange(e);break;case Guacamole.Tunnel.State.CLOSED:!i()&&n.onstatechange&&n.onstatechange(e)}},r.oninstruction=function(e,t){s(),n.oninstruction&&n.oninstruction(e,t)},r.onerror=function(e){!i(e)&&n.onerror&&n.onerror(e)},r.connect(t)}(r):n.onerror&&n.onerror(Guacamole.Status.Code.SERVER_ERROR,"No tunnels to try.")}},Guacamole.ChainedTunnel.prototype=new Guacamole.Tunnel,Guacamole.StaticHTTPTunnel=function(e,t){var n=this,a=null,o=function(e){e!==n.state&&(n.state=e,n.onstatechange&&n.onstatechange(e))};this.sendMessage=function(e){},this.connect=function(r){n.disconnect(),o(Guacamole.Tunnel.State.CONNECTING),(a=new XMLHttpRequest).open("GET",e),a.withCredentials=!!t,a.responseType="text",a.send(null);var i=0,s=new Guacamole.Parser;s.oninstruction=function(e,t){n.oninstruction&&n.oninstruction(e,t)},a.onreadystatechange=function(){if(3===a.readyState||4===a.readyState){o(Guacamole.Tunnel.State.OPEN);var e=a.responseText,t=e.length;i<t&&(s.receive(e.substring(i)),i=t)}4===a.readyState&&n.disconnect()},a.onerror=function(){n.onerror&&n.onerror(new Guacamole.Status(function(e){switch(a.status){case 400:return Guacamole.Status.Code.CLIENT_BAD_REQUEST;case 403:return Guacamole.Status.Code.CLIENT_FORBIDDEN;case 404:return Guacamole.Status.Code.RESOURCE_NOT_FOUND;case 429:return Guacamole.Status.Code.CLIENT_TOO_MANY;case 503:return Guacamole.Status.Code.SERVER_BUSY}return Guacamole.Status.Code.SERVER_ERROR}(),a.statusText)),n.disconnect()}},this.disconnect=function(){a&&(a.abort(),a=null),o(Guacamole.Tunnel.State.CLOSED)}},Guacamole.StaticHTTPTunnel.prototype=new Guacamole.Tunnel,(Guacamole=Guacamole||{}).API_VERSION="0.9.14",(Guacamole=Guacamole||{}).VideoPlayer=function(){this.sync=function(){}},Guacamole.VideoPlayer.isSupportedType=function(e){return!1},Guacamole.VideoPlayer.getSupportedTypes=function(){return[]},Guacamole.VideoPlayer.getInstance=function(e,t,n){return null};